!function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){a(2),t.exports=a(1)},function(t,e,a){},function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.r(e);var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ru-RU";n(this,t),this.layoutEngLowerCase=[["`","1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["tab","q","w","e","r","t","y","u","i","o","p","[","]","\\"],["capslock","a","s","d","f","g","h","j","k","l",";","'","enter"],["shift","z","x","c","v","b","n","m",",",".","/","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutEngUpperCase=[["~","!","@","#","$","%","^","&","*","(",")","_","+","backspace"],["tab","Q","W","E","R","T","Y","U","I","O","P","{","}","|"],["capslock","A","S","D","F","G","H","J","K","L",":",'"',"enter"],["shift","Z","X","C","V","B","N","M","<",">","?","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutRuLowerCase=[["ё","1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\"],["capslock","ф","ы","в","а","п","р","о","л","д","ж","э","enter"],["shift","я","ч","с","м","и","т","ь","б","ю",".","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutRuUpperCase=[["Ё","!",'"',"№",";","%",":","?","*","(",")","_","+","backspace"],["tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","|"],["capslock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","enter"],["shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",",","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutRuLowerCaseCaps=[["Ё","1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","\\"],["capslock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","enter"],["shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",".","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutEngLowerCaseCaps=[["`","1","2","3","4","5","6","7","8","9","0","-","=","backspace"],["tab","Q","W","E","R","T","Y","U","I","O","P","[","]","\\"],["capslock","A","S","D","F","G","H","J","K","L",";","'","enter"],["shift","Z","X","C","V","B","N","M",",",".","/","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutRuUpperCaseCaps=[["ё","!",'"',"№",";","%",":","?","*","(",")","_","+","backspace"],["tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","|"],["capslock","ф","ы","в","а","п","р","о","л","д","ж","э","enter"],["shift","я","ч","с","м","и","т","ь","б","ю",",","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutEngUpperCaseCaps=[["~","!","@","#","$","%","^","&","*","(",")","_","+","backspace"],["tab","q","w","e","r","t","y","u","i","o","p","{","}","|"],["capslock","a","s","d","f","g","h","j","k","l",":",'"',"enter"],["shift","z","x","c","v","b","n","m","<",">","?","shift"],["ctrl","win","alt","space","alt","win","ctrl"]],this.layoutKeyCode=[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"],["ControlLeft","MetaLeft","AltLeft","Space","AltRight","MetaRight","ControlRight"]],this.deleteNArrowsLayout=[["del"],["&uarr;"],["&larr;","&darr;","&rarr;"]],this.deleteNArrowsLayoutKeyCode=[["Delete"],["ArrowUp"],["ArrowLeft","ArrowDown","ArrowRight"]],this.specialButtons=["tab","capslock","shift","ctrl","win","space","backspace","del","alt","enter","&uarr;","&larr;","&darr;","&rarr;"],this.colorsEng={green:"012qazp;[]-='/",blue:"3wsx9ol.",purple:"4edc8ik,",yellow:"7ujmyhn",orange:"6tgb5rfv"},this.colorsRu={green:"12йфя0-=зхъжэ.",blue:"3цыч9щдю",purple:"8шлб4увс",yellow:"7гнроьт",orange:"65кеапми"},"ru-RU"===e?(this.language="ru-RU",this.layout=this.layoutRuLowerCase):(this.language="en-US",this.layout=this.layoutEngLowerCase),this.keyboard=this.createKeyboard()}return function(t,e,a){e&&o(t.prototype,e),a&&o(t,a)}(t,[{key:"createElement",value:function(t,e,a,n){for(var o=document.createElement(t),i=0;i<e.length;i++)o.classList.add(e[i]);return a&&Object.keys(a).forEach((function(t){o.setAttribute(t,a[t])})),n&&(o.innerHTML=n),o}},{key:"createLayout",value:function(t,e,a,n){for(var o=this.createElement(t,e),i=0;i<a.length;i++){for(var s=this.createElement("div",["keyboard__buttons-row"]),r=0;r<a[i].length;r++){var l=this.createButton(a[i][r],n[i][r]);s.appendChild(l)}o.appendChild(s)}return o}},{key:"createButton",value:function(t,e){var a=["button"],n=this.getColor(t);return this.isSpecial(t)?(a.push("button_special"),t.includes("arr")?a.push("button_special_arrow"):a.push("button_special_".concat(t))):(a.push("button_default"),a.push("button_".concat(n))),this.createElement("button",a,{id:"".concat(e)},t)}},{key:"createKeyboard",value:function(){var t=this.createElement("div",["container"]),e=this.createElement("section",["keyboard"],{id:"keyboard"}),a=this.createElement("div",["keyboard__field"]),n=this.createElement("textarea",["keyboard__textarea"],{id:"textarea",tabindex:"-1"}),o=this.createElement("div",["keyboard__buttons"]),i=this.createLayout("div",["keyboard__buttons-left"],this.layout,this.layoutKeyCode),s=this.createLayout("div",["keyboard__buttons-right"],this.deleteNArrowsLayout,this.deleteNArrowsLayoutKeyCode);return a.appendChild(n),o.appendChild(i),o.appendChild(s),e.appendChild(a),e.appendChild(o),t.appendChild(e),this.textarea=n,this.keyboardButtons=o,this.keyboardButtonsLeft=i,t}},{key:"isSpecial",value:function(t){return this.specialButtons.includes(t)}},{key:"getColor",value:function(t){for(var e="ru-RU"===this.language|"ru"?this.colorsRu:this.colorsEng,a=Object.keys(e),n=0;n<a.length;n++)if(e[a[n]].includes(t))return a[n];return"default"}},{key:"addKeyboardInElement",value:function(t){t.appendChild(this.keyboard)}},{key:"getLayout",value:function(t,e,a){for(var n=e?"UpperCase":"LowerCase",o=a?"Caps":"",i=this["layout".concat("ru-RU"===t?"Ru":"Eng").concat(n).concat(o)],s=[],r=0;r<i.length;r++)s=s.concat(i[r]);return s}},{key:"getTextarea",value:function(){return this.textarea}},{key:"getKeyboardButtonsField",value:function(){return this.keyboardButtons}},{key:"getButtons",value:function(){return this.keyboardButtonsLeft.querySelectorAll(".button")}}]),t}();function s(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keyboard=e,this.textarea=e.getTextarea(),this.keyboardButtonsField=this.keyboard.getKeyboardButtonsField(),this.buttonsList=this.keyboard.getButtons(),this.layoutLanguage=this.keyboard.language,this.case="lowerCase",this.cooldown=!1,this._shift=!1,this._alt=!1,this._capslook=!1,this._ctrl=!1,document.addEventListener("mousedown",this.onMouseDown.bind(this)),document.addEventListener("mouseup",this.onMouseUp.bind(this)),document.addEventListener("mouseout",this.onMouseOut.bind(this)),document.addEventListener("keydown",this.onKeyDown.bind(this)),document.addEventListener("keyup",this.onKeyUp.bind(this))}return function(t,e,a){e&&s(t.prototype,e),a&&s(t,a)}(t,[{key:"changeLayout",value:function(t,e,a){if(!this.cooldown){for(var n=this.keyboard.getLayout(t,e,a),o=0;o<n.length;o++)this.buttonsList[o].innerHTML=n[o];localStorage.getItem("keyboardTaskLang")!==t&&localStorage.setItem("keyboardTaskLang",t)}}},{key:"setCooldown",value:function(){this.cooldown=!0}},{key:"clearCooldown",value:function(){this.cooldown=!1}},{key:"checkAltNShift",value:function(){if(this._shift&&this._alt){switch(this.layoutLanguage){case"ru-RU":this.changeLayout("en-US",this._shift,this._capslook),this.layoutLanguage="en-US";break;case"en-US":this.changeLayout("ru-RU",this._shift,this._capslook),this.layoutLanguage="ru-RU"}return this.setCooldown(),!0}return!1}},{key:"space",value:function(){this.addSymbolToTextArea(" ")}},{key:"enter",value:function(){this.addSymbolToTextArea("\n")}},{key:"tab",value:function(){this.addSymbolToTextArea("\t")}},{key:"win",value:function(){}},{key:"del",value:function(){var t=this.textarea.selectionStart,e=this.textarea.selectionEnd;e===t?this.textarea.setRangeText("",t,e+1):this.textarea.setRangeText("",t,e)}},{key:"backspace",value:function(){var t=this.textarea.selectionStart,e=this.textarea.selectionEnd;e===t&&0!==t?this.textarea.setRangeText("",t-1,e):this.textarea.setRangeText("",t,e)}},{key:"capslock",value:function(t){"mousedown"===t||"keydown"===t?(this._capslook=!this._capslook,this.changeLayout(this.layoutLanguage,this._shift,this._capslook),this.setCooldown()):"mouseup"!==t&&"mouseout"!==t&&"keyup"!==t||this.clearCooldown()}},{key:"shift",value:function(t){switch(!0){case"mousedown"===t||"keydown"===t:this._shift=!0,this.checkAltNShift()||this.changeLayout(this.layoutLanguage,this._shift,this._capslook);break;case"mouseup"===t||"mouseout"===t||"keyup"===t:this._shift=!1,this.clearCooldown(),this.changeLayout(this.layoutLanguage,this._shift,this._capslook)}}},{key:"ctrl",value:function(t){switch(!0){case"mousedown"===t||"keydown"===t:this._ctrl=!0;break;case"mouseup"===t||"mouseout"===t||"keyup"===t:this._ctrl=!1}}},{key:"alt",value:function(t){switch(!0){case"mousedown"===t||"keydown"===t:this._alt=!0,this.checkAltNShift();break;case"mouseup"===t||"mouseout"===t||"keyup"===t:this._alt=!1,this.clearCooldown()}}},{key:"ArrowLeft",value:function(){var t=this.textarea.selectionStart,e=this.textarea.selectionEnd;0!==t&&this.textarea.setSelectionRange(t-1,e-1)}},{key:"ArrowRight",value:function(){var t=this.textarea.selectionStart,e=this.textarea.selectionEnd;e!==this.textarea.value.length&&this.textarea.setSelectionRange(t+1,e+1)}},{key:"ArrowUp",value:function(){var t=this.calculateSelectionPosition("top");void 0!==t&&this.textarea.setSelectionRange(t,t)}},{key:"ArrowDown",value:function(){var t=this.calculateSelectionPosition("bottom");void 0!==t&&this.textarea.setSelectionRange(t,t)}},{key:"calculateSelectionPosition",value:function(t){var e,a=this.textarea.selectionStart,n=this.textarea.selectionEnd,o=this.textarea.value.length,i=Array.from(this.textarea.value.matchAll(/\n/g)).map((function(t){return t.index}));if("top"===t){var s=i.filter((function(t){return t<a}));if(1===s.length){var r=s[s.length-1],l=(a-r-1)%69,c=r%69;e=l>=c?r:r-c+l}else if(s.length>1){var u=s[s.length-1],h=s[s.length-2],y=(a-u-1)%69,d=(u-h-1)%69;e=y>=d?u:u-d+y}else a>69&&(e=a-69)}if("bottom"===t){var f=i.filter((function(t){return t>=n})),p=i.filter((function(t){return t<n}));if(1===f.length){var g=f[0],k=0!==p.length?(n-p[p.length-1]-1)%69:n%69,b=(o-g)%69;e=k>=b?g+1+b:g+1+k}else if(f.length>1){var v=f[0],w=f[1],m=0!==p.length?(n-p[p.length-1]-1)%69:n%69,L=(w-v-1)%69;e=m>=L?v+L+1:v+m+1}else n+69<o&&(e=n+69)}return e}},{key:"addSymbolToTextArea",value:function(t){var e=this.textarea.selectionStart,a=this.textarea.selectionEnd;this.textarea.setRangeText(t,e,a),this.textarea.setSelectionRange(e+1,e+1),this.textarea.focus()}},{key:"onMouseDown",value:function(t){var e;"BUTTON"===t.target.tagName&&(t.preventDefault(),t.target.classList.contains("button_special")?this[e=t.target.classList.contains("button_special_arrow")?t.target.getAttribute("id"):t.target.textContent](t.type):(e=t.target.textContent,this.addSymbolToTextArea(e)),t.target.classList.add("button_active"))}},{key:"onMouseUp",value:function(t){if("BUTTON"===t.target.tagName){t.preventDefault();var e=t.target.textContent;["shift","alt","ctrl","capslock"].includes(e)&&this[e](t.type),t.target.classList.remove("button_active")}}},{key:"onMouseOut",value:function(t){if("BUTTON"===t.target.tagName){t.preventDefault();var e=t.target.textContent;["shift","alt","ctrl","capslock"].includes(e)&&this[e](t.type),t.target.classList.remove("button_active")}}},{key:"onKeyDown",value:function(t){t.preventDefault();var e,a=this.keyboardButtonsField.querySelector("#".concat(t.code));a.classList.contains("button_special")?this[e=a.classList.contains("button_special_arrow")?a.getAttribute("id"):a.textContent](t.type):(e=a.textContent,this.addSymbolToTextArea(e)),a.classList.add("button_active")}},{key:"onKeyUp",value:function(t){t.preventDefault();var e=this.keyboardButtonsField.querySelector("#".concat(t.code)),a=e.textContent;["shift","alt","ctrl","capslock"].includes(a)&&(this[a](t.type),"capslock"===a&&this._capslook)||e.classList.remove("button_active")}}]),t}(),l=new i(localStorage.getItem("keyboardTaskLang")?localStorage.getItem("keyboardTaskLang"):navigator.language),c=new r(l);window.keyboard=l,l.addKeyboardInElement(document.getElementsByTagName("body")[0]),window.controller=c}]);